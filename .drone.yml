---
kind: pipeline
name: Lineage 14.1

platform:
  os: linux
  arch: amd64

steps:
- name: build
  build:
    image: bitrvmpd/debian-build
    args:
      WORKSPACE: /usr/src/loup
    context: .
    dockerfile: Dockerfile

- name: Build Xiaomi Redmi 4X (santoni)
  image: bitrvmpd/debian-build
  commands:
  - export PATH=$PATH:/usr/bin/repo
  - mkdir -p /usr/src/los141
  - export WORKSPACE=/usr/src/los141
  - cd $WORKSPACE
  - repo init -u git://github.com/bitrvmpd/android.git -b $ANDROID_VERSION --depth=1
  - "repo sync -f -c -n --force-sync -j 5 && repo sync -f -c -l -j 5"
  - loup/tools/build.sh santoni
  environment:
    ANDROID_VERSION: cm-14.1
  volumes:
  - name: cache
    path: /usr/src

volumes:
- name: cache
  host:
    path: /usr/src

trigger:
  branch:
  - cm-14.1
  event:
  - push

...
